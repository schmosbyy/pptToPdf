<!DOCTYPE html>
<html lang="en-US" dir="ltr">
<head>
<base href="../../../../../">
<noscript><meta http-equiv="refresh" content="0; URL=../../../../../en-US/noscript.html"></noscript>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
<title>ScriptForge.TextStream service</title>
<link rel="shortcut icon" href="media/navigation/favicon.ico">
<link type="text/css" href="normalize.css" rel="Stylesheet">
<link type="text/css" href="prism.css" rel="Stylesheet">
<link type="text/css" href="default.css" rel="Stylesheet">
<script type="text/javascript" src="polyfills.js"></script><script type="text/javascript" src="languages.js"></script><script type="text/javascript" src="en-US/langnames.js"></script><script type="text/javascript" src="flexsearch.debug.js"></script><script type="text/javascript" src="prism.js"></script><script type="text/javascript" src="help2.js" defer></script><script type="text/javascript" src="a11y-toggle.js" defer></script><script type="text/javascript" src="paginathing.js" defer></script><script type="text/javascript" src="en-US/bookmarks.js" defer></script><script type="text/javascript" src="en-US/contents.js" defer></script><script type="text/javascript" src="help.js" defer></script><meta name="viewport" content="width=device-width,initial-scale=1">
</head>
<body>
<header id="TopLeftHeader"><a class="symbol" href="en-US/text/shared/05/new_help.html"><div></div></a><a class="logo" href="en-US/text/shared/05/new_help.html"><p dir="auto">LibreOffice 24.8 Help</p></a><div class="dropdowns"><div class="modules">
<button type="button" data-a11y-toggle="modules-nav" id="modules" aria-haspopup="true" aria-expanded="false" aria-controls="modules-nav">Module</button><nav id="modules-nav" hidden=""></nav>
</div></div></header><aside class="leftside"><input id="accordion-1" name="accordion-menu" type="checkbox"><label for="accordion-1" dir="auto">Contents</label><div id="Contents" class="contents-treeview"></div></aside><div id="SearchFrame"><div id="Bookmarks">
<input id="search-bar" type="search" class="search" placeholder="Search in bookmarks for chosen module" dir="auto"><div class="nav-container" tabindex="0"><nav class="index" dir="auto"></nav></div>
</div></div>
<div id="DisplayArea" itemprop="softwareHelp" itemscope="true" itemtype="http://schema.org/SoftwareApplication">

<a name="ScriptForge-SF_TextStream"></a>
  <a name="bm_id50158533078781"></a>
    <meta itemprop="keywords" content="TextStream service">
  


<a name="abstract"></a>
  <h1 id="bm_id351585330787295" dir="auto">
<a name="TextStreamService"></a><span class="literal">ScriptForge</span>.<span class="literal">TextStream</span> service</h1>
  <p id="par_id511585330787205" class="paragraph" dir="auto">The <span class="literal">TextStream</span> service is used to sequentially read from and write to files opened or created using the <span class="literal">ScriptForge.FileSystem</span> service.</p>
  <p id="par_id41613596903894" class="paragraph" dir="auto">The methods <span class="literal">OpenTextFile</span> and <span class="literal">CreateTextFile</span> from the <span class="literal">FileSystem</span> service return an instance of the <span class="literal">TextStream</span> service.</p>

  <p id="par_id161585330787262" class="paragraph" dir="auto">Line delimiters may be specified by the user. In input operations CR, LF or CR+LF are supported. In output operations, the default line delimiter is the one used by the operating system.</p>
  <p id="par_id831613598137669" class="paragraph" dir="auto">The line delimiter for the operating system where the macro is being executed can be accessed using the <span class="literal">SF_String.sfNEWLINE</span> property.</p>
  <div class="note">
<div class="noteicon" dir="auto"><img src="media/icon-themes/res/helpimg/note.svg" alt="note" style="width:40px;height:40px;"></div>
<div class="notetext"><p id="par_id851613597445432" dir="auto">All operations needed to read from or write to a file (open, read/write and close) are presumed to happen during the same macro run.</p></div>
</div>
<br>

  <h2 id="hd_id83158533078741" dir="auto">Service invocation</h2>
  <p id="par_id351613598192725" class="paragraph" dir="auto">The examples below in Basic and Python use the <span class="literal">OpenTextFile</span> method to create an instance of the <span class="literal">TextStream</span> Service.</p>
  <div class="embedded">
<a name="In_Basic"></a>
<h5 id="hd_id191620312698501" dir="auto">In Basic</h5>
</div>
  <div class="bascode" itemscope="true" itemtype="http://schema.org/SoftwareSourceCode" itemprop="codeSampleType" content="snippet" data-tooltip="Click on text to copy to clipboard"><pre dir="auto"><code class="language-visual-basic line-numbers">
    GlobalScope.BasicLibraries.LoadLibrary("ScriptForge")
    Dim FSO As Variant
    FSO = CreateScriptService("FileSystem")
    Set myFile = FSO.OpenTextFile("C:\Temp\ThisFile.txt", FSO.ForReading)
  </code></pre></div>
  <p id="par_id371585330787197" class="paragraph" dir="auto">The file must be closed with the <span class="literal">CloseFile</span> method after all read or write operations have been executed:</p>
  <div class="bascode" itemscope="true" itemtype="http://schema.org/SoftwareSourceCode" itemprop="codeSampleType" content="snippet" data-tooltip="Click on text to copy to clipboard"><pre dir="auto"><code class="language-visual-basic line-numbers">
    myFile.CloseFile()
  </code></pre></div>
  <p id="par_id891582733781994" class="paragraph" dir="auto">Optionally, the resources used by the <span class="literal">TextStream</span> instance can be released using the <span class="literal">Dispose</span> method:</p>
  <div class="bascode" itemscope="true" itemtype="http://schema.org/SoftwareSourceCode" itemprop="codeSampleType" content="snippet" data-tooltip="Click on text to copy to clipboard"><pre dir="auto"><code class="language-visual-basic line-numbers">
    Set myFile = myFile.Dispose()
  </code></pre></div>
  <div class="note">
<div class="noteicon" dir="auto"><img src="media/icon-themes/res/helpimg/note.svg" alt="note" style="width:40px;height:40px;"></div>
<div class="notetext"><p id="par_id121612917368946" dir="auto">The methods in the <span class="literal">TextStream</span> service are mostly based on the <a target="_blank" href="https://api.libreoffice.org/docs/idl/ref/interfacecom_1_1sun_1_1star_1_1io_1_1XTextInputStream.html"><span class="literal">XTextInputStream</span></a> and <a target="_blank" href="https://api.libreoffice.org/docs/idl/ref/interfacecom_1_1sun_1_1star_1_1io_1_1XTextOutputStream.html"><span class="literal">XTextOutputStream</span></a> UNO interfaces.</p></div>
</div>
<br>
  <div class="embedded">
<a name="In_Python"></a>
<h5 id="hd_id831620312769993" dir="auto">In Python</h5>
</div>
  <div class="pycode" itemscope="true" itemtype="http://schema.org/SoftwareSourceCode" itemprop="codeSampleType" content="snippet" data-tooltip="Click on text to copy to clipboard"><pre dir="auto"><code class="language-python line-numbers">
    from scriptforge import CreateScriptService
    fs = CreateScriptService("FileSystem")
    myFile = fs.OpenTextFile(r"C:\Temp\ThisFile.txt", fs.ForReading)
    # ...
    myFile.CloseFile()
    myFile = myFile.Dispose()
  </code></pre></div>

  <h2 id="hd_id941585330787948" dir="auto">Properties</h2>
  <a name="bm_id1001613600572485"></a>
    <meta itemprop="keywords" content="TextStream service,AtEndOfStream">
    <meta itemprop="keywords" content="TextStream service,Encoding">
    <meta itemprop="keywords" content="TextStream service,FileName">
    <meta itemprop="keywords" content="TextStream service,IOMode">
    <meta itemprop="keywords" content="TextStream service,Line">
    <meta itemprop="keywords" content="TextStream service,NewLine">
  
  <a name="properties_toc"></a>
   <table border="1" class="" cellpadding="0" cellspacing="0">
    <tr>
      <th rowspan="" colspan="" class="tableheadcell" dir="auto">
        <p id="par_id631585330787267" class="tableheadintable" dir="auto">Name</p>
      </th>
      <th rowspan="" colspan="" class="tableheadcell" dir="auto">
        <p id="par_id401585330787370" class="tableheadintable" dir="auto">Readonly</p>
      </th>
      <th rowspan="" colspan="" class="tableheadcell" dir="auto">
        <p id="par_id581585330787700" class="tableheadintable" dir="auto">Type</p>
      </th>
      <th rowspan="" colspan="" class="tableheadcell" dir="auto">
        <p id="par_id551585330787608" class="tableheadintable" dir="auto">Description</p>
      </th>
    </tr>
    <tr>
      <td rowspan="" colspan="" dir="auto">
        <p id="par_id941585330787832" class="tablecontentintable" dir="auto">AtEndOfStream</p>
      </td>
      <td rowspan="" colspan="" dir="auto">
        <p id="par_id181585330787752" class="tablecontentintable" dir="auto">Yes</p>
      </td>
      <td rowspan="" colspan="" dir="auto">
        <p id="par_id471585330787948" class="tablecontentintable" dir="auto">Boolean</p>
      </td>
      <td rowspan="" colspan="" dir="auto">
        <p id="par_id901585330787680" class="tablecontentintable" dir="auto">Used in read mode. A <span class="literal">True</span> value indicates that the end of the file has been reached. A test using this property should precede calls to the <span class="literal">ReadLine</span> method.</p>
      </td>
    </tr>
    <tr>
      <td rowspan="" colspan="" dir="auto">
        <p id="par_id501585330787895" class="tablecontentintable" dir="auto">Encoding</p>
      </td>
      <td rowspan="" colspan="" dir="auto">
        <p id="par_id561585330787568" class="tablecontentintable" dir="auto">Yes</p>
      </td>
      <td rowspan="" colspan="" dir="auto">
        <p id="par_id731585330787673" class="tablecontentintable" dir="auto">String</p>
      </td>
      <td rowspan="" colspan="" dir="auto">
        <p id="par_id741585330787777" class="tablecontentintable" dir="auto">The character set to be used. The default encoding is "UTF-8".</p>
      </td>
    </tr>
    <tr>
      <td rowspan="" colspan="" dir="auto">
        <p id="par_id361585330787241" class="tablecontentintable" dir="auto">FileName</p>
      </td>
      <td rowspan="" colspan="" dir="auto">
        <p id="par_id641585330787207" class="tablecontentintable" dir="auto">Yes</p>
      </td>
      <td rowspan="" colspan="" dir="auto">
        <p id="par_id9158533078741" class="tablecontentintable" dir="auto">String</p>
      </td>
      <td rowspan="" colspan="" dir="auto">
        <p id="par_id281585330787614" class="tablecontentintable" dir="auto">Returns the name of the current file either in URL format or in the native operating system's format, depending on the current value of the <span class="literal">FileNaming</span> property of the <span class="literal">FileSystem</span> service.</p>
      </td>
    </tr>
    <tr>
      <td rowspan="" colspan="" dir="auto">
        <p id="par_id451585330787745" class="tablecontentintable" dir="auto">IOMode</p>
      </td>
      <td rowspan="" colspan="" dir="auto">
        <p id="par_id111585330787410" class="tablecontentintable" dir="auto">Yes</p>
      </td>
      <td rowspan="" colspan="" dir="auto">
        <p id="par_id981585330787716" class="tablecontentintable" dir="auto">String</p>
      </td>
      <td rowspan="" colspan="" dir="auto">
        <p id="par_id861585330787417" class="tablecontentintable" dir="auto">Indicates the input/output mode. Possible values are "READ", "WRITE" or "APPEND".</p>
      </td>
    </tr>
    <tr>
      <td rowspan="" colspan="" dir="auto">
        <p id="par_id721585330787688" class="tablecontentintable" dir="auto">Line</p>
      </td>
      <td rowspan="" colspan="" dir="auto">
        <p id="par_id87158533078795" class="tablecontentintable" dir="auto">Yes</p>
      </td>
      <td rowspan="" colspan="" dir="auto">
        <p id="par_id601585330787171" class="tablecontentintable" dir="auto">Long</p>
      </td>
      <td rowspan="" colspan="" dir="auto">
        <p id="par_id561585330787741" class="tablecontentintable" dir="auto">Returns the number of lines read or written so far.</p>
      </td>
    </tr>
    <tr>
      <td rowspan="" colspan="" dir="auto">
        <p id="par_id12158533078767" class="tablecontentintable" dir="auto">NewLine</p>
      </td>
      <td rowspan="" colspan="" dir="auto">
        <p id="par_id531585330787157" class="tablecontentintable" dir="auto">No</p>
      </td>
      <td rowspan="" colspan="" dir="auto">
        <p id="par_id9415853307876" class="tablecontentintable" dir="auto">String</p>
      </td>
      <td rowspan="" colspan="" dir="auto">
        <p id="par_id691585330787279" class="tablecontentintable" dir="auto">Sets or returns the current delimiter to be inserted between two successive written lines. The default value is the native line delimiter in the current operating system.</p>
      </td>
    </tr>
   </table>
<br>
  
  <div class="note">
<div class="noteicon" dir="auto"><img src="media/icon-themes/res/helpimg/note.svg" alt="note" style="width:40px;height:40px;"></div>
<div class="notetext"><p id="par_id141613001281573" dir="auto">To learn more about the names of character sets, visit <a target="_blank" href="https://www.iana.org/assignments/character-sets/character-sets.xhtml">IANA's Character Set</a> page. Be aware that LibreOffice does not implement all existing character sets.</p></div>
</div>
<br>
  <a name="methods_toc"></a>
   <table border="1" class="" cellpadding="0" cellspacing="0">
    <tr>
      <th rowspan="" colspan="3" class="tableheadcell" dir="auto">
        <p id="par_id891611613601554" class="tableheadintable" dir="auto">List of Methods in the TextStream Service</p>
      </th>
    </tr>
    <tr>
       <td rowspan="" colspan="" dir="auto">
           <p id="par_id891611613601556" class="tablecontentintable" dir="auto">
             <a target="_top" href="en-US/text/sbasic/shared/03/sf_textstream.html#CloseFile">CloseFile</a><br>
             <a target="_top" href="en-US/text/sbasic/shared/03/sf_textstream.html#ReadAll">ReadAll</a><br>
           </p>
       </td>
       <td rowspan="" colspan="" dir="auto">
           <p id="par_id541611613601554" class="tablecontentintable" dir="auto">
             <a target="_top" href="en-US/text/sbasic/shared/03/sf_textstream.html#ReadLine">ReadLine</a><br>
             <a target="_top" href="en-US/text/sbasic/shared/03/sf_textstream.html#SkipLine">SkipLine</a><br>
           </p>
       </td>
       <td rowspan="" colspan="" dir="auto">
           <p id="par_id701611613601554" class="tablecontentintable" dir="auto">
             <a target="_top" href="en-US/text/sbasic/shared/03/sf_textstream.html#WriteBlankLines">WriteBlankLines</a><br>
             <a target="_top" href="en-US/text/sbasic/shared/03/sf_textstream.html#WriteLine">WriteLine</a><br>
           </p>
       </td>
    </tr>
   </table>
<br>
  

<a name="CloseFile"></a>
  
  <a name="bm_id21585330787288"></a>
    <meta itemprop="keywords" content="TextStream service,CloseFile">
  
  <h2 id="hd_id901585330787252" dir="auto">CloseFile</h2>
  <p id="par_id421585330787675" class="paragraph" dir="auto">Closes the current input or output stream and empties the output buffer if relevant. Returns <span class="literal">True</span> if the file was successfully closed.</p>
  <div class="embedded">
<a name="functsyntax"></a>
<h3 id="hd_id061420171139089682" dir="auto">Syntax:</h3>
</div>
  <p id="par_id971626891612501" class="paragraph" dir="auto">
    <span class="input" data-tooltip="Click on text to copy to clipboard">myFile.CloseFile(): bool</span>
  </p>


<a name="ReadAll"></a>
  
  <a name="bm_id311585330787690"></a>
    <meta itemprop="keywords" content="TextStream service,ReadAll">
  
  <h2 id="hd_id311585330787335" dir="auto">ReadAll</h2>
  <p id="par_id65158533078799" class="paragraph" dir="auto">Returns all the remaining lines in the text stream as a single string. Line breaks are not removed.</p>
  <p id="par_id71613600347125" class="paragraph" dir="auto">The resulting string can be split in lines either by using the <span class="literal">Split</span> built-in Basic function if the line delimiter is known, or with the <span class="literal">SF_String.SplitLines</span> method.</p>
  <p id="par_id91585330787373" class="paragraph" dir="auto">For large files, using the <span class="literal">ReadAll</span> method wastes memory resources. In such cases it is recommended to read the file line by line using the <span class="literal">ReadLine</span> method.</p>
  <div class="embedded">
<a name="functsyntax"></a>
<h3 id="hd_id061420171139089682" dir="auto">Syntax:</h3>
</div>
  <p id="par_id501626891694491" class="paragraph" dir="auto">
    <span class="input" data-tooltip="Click on text to copy to clipboard">myFile.ReadAll(): str</span>
  </p>
  <div class="embedded">
<a name="functexample"></a>
<h3 id="hd_id061420171139088233" dir="auto">Example:</h3>
</div>
  <p id="par_id921613595637851" class="paragraph" dir="auto">Consider the text file "Students.txt" with the following contents (a name in each line):</p>
  <div class="bascode" itemscope="true" itemtype="http://schema.org/SoftwareSourceCode" itemprop="codeSampleType" content="snippet" data-tooltip="Click on text to copy to clipboard"><pre dir="auto"><code class="language-visual-basic line-numbers">
    Herbie Peggy
    Hardy Jarrett
    Edith Lorelle
    Roderick Rosamund
    Placid Everette
  </code></pre></div>
  <p id="par_id391613596019750" class="paragraph" dir="auto">The examples below in Basic and Python use the <span class="literal">ReadAll</span> and <span class="literal">SplitLines</span> methods to read the contents of the file into an array of strings:</p>
  <div class="embedded">
<a name="In_Basic"></a>
<h5 id="hd_id191620312698501" dir="auto">In Basic</h5>
</div>
  <div class="bascode" itemscope="true" itemtype="http://schema.org/SoftwareSourceCode" itemprop="codeSampleType" content="snippet" data-tooltip="Click on text to copy to clipboard"><pre dir="auto"><code class="language-visual-basic line-numbers">
    'Loads the FileSystem service
    Dim FSO : FSO = CreateScriptService("FileSystem")
    'Opens the text file with the names to be read
    Dim inputFile as Object
    Set inputFile = FSO.OpenTextFile("/home/user/Documents/Students.txt")
    'Reads all the contents in the input file as a single string
    Dim allData as String
    allData = inputFile.ReadAll()
    'Splits the string into an array
    Dim arrNames as Variant
    arrNames = SF_String.SplitLines(allData)
    ' (...)
    inputFile.CloseFile()
  </code></pre></div>
  <div class="embedded">
<a name="In_Python"></a>
<h5 id="hd_id831620312769993" dir="auto">In Python</h5>
</div>
  <div class="pycode" itemscope="true" itemtype="http://schema.org/SoftwareSourceCode" itemprop="codeSampleType" content="snippet" data-tooltip="Click on text to copy to clipboard"><pre dir="auto"><code class="language-python line-numbers">
    fs = CreateScriptService("FileSystem")
    inputFile = fs.OpenTextFile("/home/user/Documents/Students.txt")
    allData = inputFile.ReadAll()
    arrNames = allData.split(inputFile.NewLine)
    # ...
    inputFile.CloseFile()
  </code></pre></div>


<a name="ReadLine"></a>
  
  <a name="bm_id161585330787462"></a>
    <meta itemprop="keywords" content="TextStream service,ReadLine">
  
  <h2 id="hd_id111585330787998" dir="auto">ReadLine</h2>
  <p id="par_id871585330787885" class="paragraph" dir="auto">Returns the next line in the text stream as a string. Line breaks are removed from the returned string.</p>
  <p id="par_id431613600221626" class="paragraph" dir="auto">The <span class="literal">AtEndOfStream</span> test should precede the <span class="literal">ReadLine</span> method like in the example below.</p>
  <p id="par_id171585330787774" class="paragraph" dir="auto">An error will be raised if the <span class="literal">AtEndOfStream</span> was reached during the previous <span class="literal">ReadLine</span> or <span class="literal">SkipLine</span> method call.</p>
  <div class="embedded">
<a name="functsyntax"></a>
<h3 id="hd_id061420171139089682" dir="auto">Syntax:</h3>
</div>
  <p id="par_id431626892013564" class="paragraph" dir="auto">
    <span class="input" data-tooltip="Click on text to copy to clipboard">myFile.ReadLine(): str</span>
  </p>
  <div class="embedded">
<a name="functexample"></a>
<h3 id="hd_id061420171139088233" dir="auto">Example:</h3>
</div>
  <div class="embedded">
<a name="In_Basic"></a>
<h5 id="hd_id191620312698501" dir="auto">In Basic</h5>
</div>
  <div class="bascode" itemscope="true" itemtype="http://schema.org/SoftwareSourceCode" itemprop="codeSampleType" content="snippet" data-tooltip="Click on text to copy to clipboard"><pre dir="auto"><code class="language-visual-basic line-numbers">
    Dim sLine As String
    Do While Not myFile.AtEndOfStream
        sLine = myFile.ReadLine()
        ' (...)
    Loop
  </code></pre></div>
  <div class="embedded">
<a name="In_Python"></a>
<h5 id="hd_id831620312769993" dir="auto">In Python</h5>
</div>
  <div class="pycode" itemscope="true" itemtype="http://schema.org/SoftwareSourceCode" itemprop="codeSampleType" content="snippet" data-tooltip="Click on text to copy to clipboard"><pre dir="auto"><code class="language-python line-numbers">
    while not myFile.AtEndOfStream:
        sLine = myFile.ReadLine()
        # ...
  </code></pre></div>


<a name="SkipLine"></a>
  
  <a name="bm_id381585330787551"></a>
    <meta itemprop="keywords" content="TextStream service,SkipLine">
  
  <h2 id="hd_id241585330787168" dir="auto">SkipLine</h2>
  <p id="par_id11585330787847" class="paragraph" dir="auto">Skips the next line in the input stream when reading a <span class="literal">TextStream</span> file.</p>
  <p id="par_id441613600704766" class="paragraph" dir="auto">This method can result in <span class="literal">AtEndOfStream</span> being set to <span class="literal">True</span>.</p>
  <div class="embedded">
<a name="functsyntax"></a>
<h3 id="hd_id061420171139089682" dir="auto">Syntax:</h3>
</div>
  <p id="par_id41626892171105" class="paragraph" dir="auto">
    <span class="input" data-tooltip="Click on text to copy to clipboard">myFile.SkipLine()</span>
  </p>


<a name="WriteBlankLines"></a>
  
  <a name="bm_id61585330787548"></a>
    <meta itemprop="keywords" content="TextStream service,WriteBlankLines">
  
  <h2 id="hd_id241585330787109" dir="auto">WriteBlankLines</h2>
  <p id="par_id141585330787657" class="paragraph" dir="auto">Writes a specified number of empty lines to the output stream.</p>
  <div class="embedded">
<a name="functsyntax"></a>
<h3 id="hd_id061420171139089682" dir="auto">Syntax:</h3>
</div>
  <p id="par_id531626892281078" class="paragraph" dir="auto">
    <span class="input" data-tooltip="Click on text to copy to clipboard">myFile.WriteBlankLines(lines: int)</span>
  </p>
  <div class="embedded">
<a name="functparameters"></a>
<h3 id="hd_id061420171139084157" dir="auto">Parameters:</h3>
</div>
  <p id="par_id291585330787357" class="paragraph" dir="auto"><span class="emph">lines</span>: The number of empty lines to write to the file.</p>


<a name="WriteLine"></a>
  
  <a name="bm_id371585330787255"></a>
    <meta itemprop="keywords" content="TextStream service,WriteLine">
  
  <h2 id="hd_id611585330787877" dir="auto">WriteLine</h2>
  <p id="par_id101585330787215" class="paragraph" dir="auto">Writes the given string to the output stream as a single line.</p>
  <p id="par_id421613601002074" class="paragraph" dir="auto">The character defined in the <span class="literal">NewLine</span> property is used as the line delimiter.</p>
  <div class="embedded">
<a name="functsyntax"></a>
<h3 id="hd_id061420171139089682" dir="auto">Syntax:</h3>
</div>
  <p id="par_id791626892414752" class="paragraph" dir="auto">
    <span class="input" data-tooltip="Click on text to copy to clipboard">myFile.WriteLine(line: str)</span>
  </p>
  <div class="embedded">
<a name="functparameters"></a>
<h3 id="hd_id061420171139084157" dir="auto">Parameters:</h3>
</div>
  <p id="par_id491585330787650" class="paragraph" dir="auto"><span class="emph">line</span>: The line to write, may be empty.</p>
  <div class="embedded">
<a name="functexample"></a>
<h3 id="hd_id061420171139088233" dir="auto">Example:</h3>
</div>
  <p id="par_id821626894480105" class="paragraph" dir="auto">The examples below in Basic and Python create a text file in CSV format in which each line contains a value and its square until <span class="literal">lastValue</span> is reached.</p>
  <div class="embedded">
<a name="In_Basic"></a>
<h5 id="hd_id191620312698501" dir="auto">In Basic</h5>
</div>
  <div class="bascode" itemscope="true" itemtype="http://schema.org/SoftwareSourceCode" itemprop="codeSampleType" content="snippet" data-tooltip="Click on text to copy to clipboard"><pre dir="auto"><code class="language-visual-basic line-numbers">
    Sub SquaredValuesFile(lastValue as Integer)
        'Instantiates the FileSystem Service
        Dim FSO as Variant : FSO = CreateScriptService("FileSystem")
        'Creates a text file
        Dim myFile as Variant : myFile = FSO.CreateTextFile("/home/user/Documents/squares.csv")
        'Writes the Value and Value squared, separated by ";"
        Dim value as Integer
        myFile.WriteLine("Value;Value Squared")
        For value = 1 To lastValue
            myFile.WriteLine(value &amp; ";" &amp; value ^ 2)
        Next value
        'Closes the file and free resources
        myFile.CloseFile()
        Set myFile = myFile.Dispose()
    End Sub
  </code></pre></div>
  <div class="embedded">
<a name="In_Python"></a>
<h5 id="hd_id831620312769993" dir="auto">In Python</h5>
</div>
  <div class="pycode" itemscope="true" itemtype="http://schema.org/SoftwareSourceCode" itemprop="codeSampleType" content="snippet" data-tooltip="Click on text to copy to clipboard"><pre dir="auto"><code class="language-python line-numbers">
    def squared_values_file(lastValue):
        fs = CreateScriptService("FileSystem")
        myFile = fs.CreateTextFile("/home/user/Documents/squares.csv")
        myFile.WriteLine("Value;Value Squared")
        for value in range(1, lastValue + 1):
            myFile.WriteLine("{};{}".format(value, value ** 2))
        myFile.CloseFile()
        myFile = myFile.Dispose()
  </code></pre></div>


<div class="embedded">
<a name="SF_InternalUse"></a>
      <div class="warning">
<div class="noteicon" dir="auto"><img src="media/icon-themes/res/helpimg/warning.svg" alt="warning" style="width:40px;height:40px;"></div>
<div class="notetext"><p id="par_id851506659675843" dir="auto">All <span class="literal">ScriptForge</span> Basic routines or identifiers that are prefixed with an underscore character "_" are reserved for internal use. They are not meant be used in Basic macros or Python scripts.</p></div>
</div>
<br>
    </div>
<a name="relatedtopics"></a><div class="relatedtopics">
<p class="related" itemprop="mentions" dir="auto"><a name="related"></a><span class="emph">Related Topics</span>
</p>
<div class="relatedbody" itemprop="mentions">
  <div class="embedded"><p class="embedded" dir="auto"><a target="_top" href="en-US/text/sbasic/shared/03/sf_filesystem.html"><span class="literal">ScriptForge</span>.<span class="literal">FileSystem</span> service</a></p></div>
  <div class="embedded"><p class="embedded" dir="auto"><a target="_top" href="en-US/text/sbasic/shared/03160000.html">Input Function [VBA]</a></p></div>
  <div class="embedded"><p class="embedded" dir="auto"><a target="_top" href="en-US/text/sbasic/shared/03020103.html">Open Statement</a></p></div>
</div>
</div>
</div>
<div id="DonationFrame"></div>
<footer><h2 style="text-align: center;"><a href="https://books.libreoffice.org" target="_blank">LibreOffice Books</a></h2>
<div class="noteicon" dir="auto" style="display:flex;justify-content:center;">
<img src="media/navigation/libo-writer.svg" alt="Writer Icon" style="width:60px;height:60px;"><img src="media/navigation/libo-calc.svg" alt="Calc Icon" style="width:60px;height:60px;"><img src="media/navigation/libo-impress.svg" alt="Impress Icon" style="width:60px;height:60px;"><img src="media/navigation/libo-draw.svg" alt="Draw Icon" style="width:60px;height:60px;"><img src="media/navigation/libo-base.svg" alt="Base Icon" style="width:60px;height:60px;"><img src="media/navigation/libo-math.svg" alt="Math Icon" style="width:60px;height:60px;"><img src="media/navigation/libo-symbol-black.svg" alt="Getting Started Icon" style="width:60px;height:60px;">
</div>
<div id="DEBUG" class="debug">
<h3 class="bug">Help content debug info:</h3>
<p dir="auto">This page is: <a href="https://opengrok.libreoffice.org/xref/help/source/text/sbasic/shared/03/sf_textstream.xhp" target="_blank">/text/sbasic/shared/03/sf_textstream.xhp</a></p>
<p dir="auto">Title is: ScriptForge.TextStream service</p>
<p id="bm_module" dir="auto"></p>
<p id="bm_system" dir="auto"></p>
<p id="bm_HID" dir="auto"></p>
</div></footer>
</body>
</html>
