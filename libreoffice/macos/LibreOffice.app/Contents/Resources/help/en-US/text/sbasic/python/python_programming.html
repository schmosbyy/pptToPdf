<!DOCTYPE html>
<html lang="en-US" dir="ltr">
<head>
<base href="../../../../">
<noscript><meta http-equiv="refresh" content="0; URL=../../../../en-US/noscript.html"></noscript>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
<title>Python : Programming with Python</title>
<link rel="shortcut icon" href="media/navigation/favicon.ico">
<link type="text/css" href="normalize.css" rel="Stylesheet">
<link type="text/css" href="prism.css" rel="Stylesheet">
<link type="text/css" href="default.css" rel="Stylesheet">
<script type="text/javascript" src="polyfills.js"></script><script type="text/javascript" src="languages.js"></script><script type="text/javascript" src="en-US/langnames.js"></script><script type="text/javascript" src="flexsearch.debug.js"></script><script type="text/javascript" src="prism.js"></script><script type="text/javascript" src="help2.js" defer></script><script type="text/javascript" src="a11y-toggle.js" defer></script><script type="text/javascript" src="paginathing.js" defer></script><script type="text/javascript" src="en-US/bookmarks.js" defer></script><script type="text/javascript" src="en-US/contents.js" defer></script><script type="text/javascript" src="help.js" defer></script><meta name="viewport" content="width=device-width,initial-scale=1">
</head>
<body>
<header id="TopLeftHeader"><a class="symbol" href="en-US/text/shared/05/new_help.html"><div></div></a><a class="logo" href="en-US/text/shared/05/new_help.html"><p dir="auto">LibreOffice 24.8 Help</p></a><div class="dropdowns"><div class="modules">
<button type="button" data-a11y-toggle="modules-nav" id="modules" aria-haspopup="true" aria-expanded="false" aria-controls="modules-nav">Module</button><nav id="modules-nav" hidden=""></nav>
</div></div></header><aside class="leftside"><input id="accordion-1" name="accordion-menu" type="checkbox"><label for="accordion-1" dir="auto">Contents</label><div id="Contents" class="contents-treeview"></div></aside><div id="SearchFrame"><div id="Bookmarks">
<input id="search-bar" type="search" class="search" placeholder="Search in bookmarks for chosen module" dir="auto"><div class="nav-container" tabindex="0"><nav class="index" dir="auto"></nav></div>
</div></div>
<div id="DisplayArea" itemprop="softwareHelp" itemscope="true" itemtype="http://schema.org/SoftwareApplication">
    <a name="N0218"></a>
      <meta itemprop="keywords" content="Python,Programming">
      <meta itemprop="keywords" content="XSCRIPTCONTEXT,Python">
      <meta itemprop="keywords" content="XSCRIPTCONTEXT,getComponentContext">
      <meta itemprop="keywords" content="XSCRIPTCONTEXT,getDesktop">
      <meta itemprop="keywords" content="XSCRIPTCONTEXT,getDocument">
      <meta itemprop="keywords" content="uno.py,getComponentContext">
      <meta itemprop="keywords" content="uno.py,getDesktop">
      <meta itemprop="keywords" content="uno.py,getDocument">
    
    <a name="pythonprogramming"></a>
        <h1 id="hd_id691546462755220" dir="auto">
<a name="pythonprogrammingheading"></a>Programming with Python Scripts</h1>
    
    <p id="N0220" class="paragraph" dir="auto">A Python macro is a function within a .py file, identified as a module. Unlike LibreOffice Basic and its dozen of <a target="_top" href="en-US/text/sbasic/shared/uno_objects.html">UNO objects functions or services</a>, Python macros use the <span class="literal">XSCRIPTCONTEXT</span> UNO single object, shared with JavaScript and BeanShell. The <span class="literal">g_exportedScripts</span> global tuple explicitly lists selectable macros from a module. Python modules hold autonomous code logic, and are independent from one another.</p>
    <h2 id="N0221" dir="auto">XSCRIPTCONTEXT Global Variable</h2>
    <p id="N0222" class="paragraph" dir="auto">Genuine Basic UNO facilities can be inferred from <span class="literal">XSCRIPTCONTEXT</span> global variable. Refer to LibreOffice API for a complete <a target="_blank" href="https://api.libreoffice.org/docs/idl/ref/interfacecom_1_1sun_1_1star_1_1script_1_1provider_1_1XScriptContext.html">description of XSCRIPTCONTEXT</a>. <span class="literal">XSCRIPTCONTEXT</span> methods summarize as:</p>
    <table border="1" class="" cellpadding="0" cellspacing="0">
        <tr>
            <th rowspan="" colspan="" class="tableheadcell" dir="auto">
                <p id="N0224" class="tableheadintable" dir="auto">Methods</p>
            </th>
            <th rowspan="" colspan="" class="tableheadcell" dir="auto">
                <p id="N0225" class="tableheadintable" dir="auto">Description</p>
            </th>
            <th rowspan="" colspan="" class="tableheadcell" dir="auto">
                <p id="N0226" class="tableheadintable" dir="auto">Mapped in Basic as</p>
            </th>
        </tr>
        <tr>
            <td rowspan="" colspan="" dir="auto">
                <p id="N0227" class="tablecontentintable" dir="auto">getDocument()</p>
            </td>
            <td rowspan="" colspan="" dir="auto">
                <p id="N0228" class="tablecontentintable" dir="auto">The document reference on which the script can operate.</p>
            </td>
            <td rowspan="" colspan="" dir="auto">
                <p id="N0229" class="tablecontentintable" dir="auto">ThisComponent</p>
            </td>
        </tr>
        <tr>
            <td rowspan="" colspan="" dir="auto">
                <p id="N0230" class="tablecontentintable" dir="auto">getDesktop()</p>
            </td>
            <td rowspan="" colspan="" dir="auto">
                <p id="N0231" class="tablecontentintable" dir="auto">The desktop reference on which the script can operate.</p>
            </td>
            <td rowspan="" colspan="" dir="auto">
                <p id="N0232" class="tablecontentintable" dir="auto">StarDesktop</p>
            </td>
        </tr>
        <tr>
            <td rowspan="" colspan="" dir="auto">
                <p id="N0233" class="tablecontentintable" dir="auto">getComponentContext()</p>
            </td>
            <td rowspan="" colspan="" dir="auto">
                <p id="N0234" class="tablecontentintable" dir="auto">The component context which the script can use to create other uno components.</p>
            </td>
            <td rowspan="" colspan="" dir="auto">
                <p id="N0235" class="tablecontentintable" dir="auto">GetDefaultContext</p>
            </td>
        </tr>
    </table>
<br>
    <p id="N0237" class="paragraph" dir="auto"><span class="emph">HelloWorld</span> and <span class="emph">Capitalise</span> installation shared scripts illustrate UNO-related macros making use of <span class="literal">XSCRIPTCONTEXT</span> global variable.</p>
    <div class="tip">
<div class="noteicon" dir="auto"><img src="media/icon-themes/res/helpimg/tip.svg" alt="tip" style="width:40px;height:40px;"></div>
<div class="notetext"><p id="N0238" dir="auto">Python standard output file is not available when running Python macros from <span class="menuitem">Tools - Macros - Run Macro</span> menu. Refer to <span class="emph">Input/Output to Screen</span> for more information.</p></div>
</div>
<br>
    <h2 id="N0239" dir="auto">Module import</h2>
    <div class="warning">
<div class="noteicon" dir="auto"><img src="media/icon-themes/res/helpimg/warning.svg" alt="warning" style="width:40px;height:40px;"></div>
<div class="notetext"><p id="N0240" dir="auto"><span class="literal">XSCRIPTCONTEXT</span> is not provided to imported modules.</p></div>
</div>
<br>
    <a name="PythonFileSystemImport"></a>
        <p id="N0241" class="paragraph" dir="auto">LibreOffice Basic libraries contain classes, routines and variables, Python modules contain classes, functions and variables. Common pieces of reusable Python or UNO features must be stored in <a target="_top" href="en-US/text/sbasic/python/python_locations.html">My macros</a> within <span class="literal">(User Profile)/Scripts/python/pythonpath</span>. Python libraries help organize modules in order to prevent module name collisions. Import <span class="literal">uno.py</span> inside shared modules.</p>
    
  <a name="uno"></a>
    <p id="N0242" class="paragraph" dir="auto">Genuine BASIC UNO facilities can be inferred using <span class="literal">uno.py</span> module. Use <a target="_top" href="en-US/text/sbasic/python/python_shell.html">Python interactive shell</a> to get a complete module description using <span class="literal">dir()</span> and <span class="literal">help()</span> Python commands.</p>
      <a name="bm_id391659034206678"></a>
        <meta itemprop="keywords" content="uno.py">
        <meta itemprop="keywords" content="uno.py,absolutize">
        <meta itemprop="keywords" content="uno.py,createUnoStruct">
        <meta itemprop="keywords" content="uno.py,fileUrlToSystemPath">
        <meta itemprop="keywords" content="uno.py,getClass">
        <meta itemprop="keywords" content="uno.py,getComponentContext">
        <meta itemprop="keywords" content="uno.py,Enum">
        <meta itemprop="keywords" content="uno.py,getConstantByName">
        <meta itemprop="keywords" content="uno.py,isInterface">
        <meta itemprop="keywords" content="uno.py,systemPathToFileUrl">
      
    <table border="1" class="" cellpadding="0" cellspacing="0">
        <tr>
            <th rowspan="" colspan="" class="tableheadcell" dir="auto">
                <p id="N0244" class="tableheadintable" dir="auto">Functions</p>
            </th>
            <th rowspan="" colspan="" class="tableheadcell" dir="auto">
                <p id="N0245" class="tableheadintable" dir="auto">Description</p>
            </th>
            <th rowspan="" colspan="" class="tableheadcell" dir="auto">
                <p id="N0246" class="tableheadintable" dir="auto">Mapped in Basic as</p>
            </th>
        </tr>
        <tr>
            <td rowspan="" colspan="" dir="auto">
                <p id="N0247" class="tablecontentintable" dir="auto">absolutize()</p>
            </td>
            <td rowspan="" colspan="" dir="auto">
                <p id="N0248" class="tablecontentintable" dir="auto">Returns an absolute file url from the given urls.</p>
            </td>
            <td rowspan="" colspan="" dir="auto">
            </td>
        </tr>
        <tr>
            <td rowspan="" colspan="" dir="auto">
                <p id="N0250" class="tablecontentintable" dir="auto">createUnoStruct()</p>
            </td>
            <td rowspan="" colspan="" dir="auto">
                <p id="N0251" class="tablecontentintable" dir="auto">Creates a UNO struct or exception given by typeName.</p>
            </td>
            <td rowspan="" colspan="" dir="auto">
                <p id="N0252" class="tablecontentintable" dir="auto">CreateUNOStruct()</p>
            </td>
        </tr>
        <tr>
            <td rowspan="" colspan="" dir="auto">
                <p id="N0253" class="tablecontentintable" dir="auto">fileUrlToSystemPath()</p>
            </td>
            <td rowspan="" colspan="" dir="auto">
                <p id="N0254" class="tablecontentintable" dir="auto">Returns a system path.</p>
            </td>
            <td rowspan="" colspan="" dir="auto">
                <p id="N0255" class="tablecontentintable" dir="auto">ConvertFromURL()</p>
            </td>
        </tr>
        <tr>
            <td rowspan="" colspan="" dir="auto">
                <p id="N0256" class="tablecontentintable" dir="auto">getClass()</p>
            </td>
            <td rowspan="" colspan="" dir="auto">
                <p id="N0257" class="tablecontentintable" dir="auto">Returns the class of a concrete UNO exception, struct, or interface.</p>
            </td>
            <td rowspan="" colspan="" dir="auto">
            </td>
        </tr>
        <tr>
            <td rowspan="" colspan="" dir="auto">
                <p id="N0259" class="tablecontentintable" dir="auto">getComponentContext()</p>
            </td>
            <td rowspan="" colspan="" dir="auto">
                <p id="N0260" class="tablecontentintable" dir="auto">Returns the UNO component context used to initialize the Python runtime.</p>
            </td>
            <td rowspan="" colspan="" dir="auto">
                <p id="N0261" class="tablecontentintable" dir="auto">GetDefaultContext()</p>
            </td>
        </tr>
        <tr>
            <td rowspan="" colspan="" dir="auto">
                <p id="N0262" class="tablecontentintable" dir="auto">Enum()</p>
                <p id="N0263" class="tablecontentintable" dir="auto">getConstantByName()</p>
            </td>
            <td rowspan="" colspan="" dir="auto">
                <p id="N0264" class="tablecontentintable" dir="auto">Looks up the value of an IDL constant by giving its explicit name.</p>
            </td>
            <td rowspan="" colspan="" dir="auto">
                <p id="N0265" class="tablecontentintable" dir="auto">See API constant groups</p>
            </td>
        </tr>
        <tr>
            <td rowspan="" colspan="" dir="auto">
                <p id="N0266" class="tablecontentintable" dir="auto">isInterface()</p>
            </td>
            <td rowspan="" colspan="" dir="auto">
                <p id="N0267" class="tablecontentintable" dir="auto">Returns True, when obj is a class of a UNO interface.</p>
            </td>
            <td rowspan="" colspan="" dir="auto">
            </td>
        </tr>
        <tr>
            <td rowspan="" colspan="" dir="auto">
                <p id="N0269" class="tablecontentintable" dir="auto">systemPathToFileUrl()</p>
            </td>
            <td rowspan="" colspan="" dir="auto">
                <p id="N0270" class="tablecontentintable" dir="auto">Returns a file URL for the given system path.</p>
            </td>
            <td rowspan="" colspan="" dir="auto">
                <p id="N0271" class="tablecontentintable" dir="auto">ConvertToURL()</p>
            </td>
        </tr>
    </table>
<br>
  
    <p id="N0272" class="paragraph" dir="auto"><span class="emph">LibreLogo</span>, <span class="emph">NamedRanges</span>, <span class="emph">SetCellColor</span> and <span class="emph">TableSample</span> preinstalled scripts use <span class="literal">uno.py</span> module.</p>
    <h2 id="N0273" dir="auto">More Python-Basic samples</h2>
    <table border="1" class="" cellpadding="0" cellspacing="0">
        <tr>
            <th rowspan="" colspan="" class="tableheadcell" dir="auto">
                <p id="N0275" class="tableheadintable" dir="auto">Python UNO</p>
            </th>
            <th rowspan="" colspan="" class="tableheadcell" dir="auto">
                <p id="N0276" class="tableheadintable" dir="auto">Basic UNO features</p>
            </th>
        </tr>
        <tr>
            <td rowspan="" colspan="" dir="auto">
                <p id="N0277" class="tablecontentintable" dir="auto">ctx = uno.getComponentContext()</p>
                <p id="N0278" class="tablecontentintable" dir="auto">smgr = ctx.getServiceManager()</p>
                <p id="N0279" class="tablecontentintable" dir="auto">obj = smgr.createInstanceWithContext( .. , ctx)</p>
            </td>
            <td rowspan="" colspan="" dir="auto">
                <p id="N0280" class="tablecontentintable" dir="auto">CreateUnoService()</p>
            </td>
        </tr>
        <tr>
            <td rowspan="" colspan="" dir="auto">
                <p id="N0284" class="tablecontentintable" dir="auto">See <a target="_top" href="en-US/text/sbasic/python/python_dialogs.html">Opening a Dialog</a></p>
            </td>
            <td rowspan="" colspan="" dir="auto">
                <p id="N0285" class="tablecontentintable" dir="auto">CreateUnoDialog()</p>
            </td>
        </tr>
        <tr>
            <td rowspan="" colspan="" dir="auto">
                <p id="N0286" class="tablecontentintable" dir="auto">See <a target="_top" href="en-US/text/sbasic/python/python_listener.html">Creating a Listener</a></p>
            </td>
            <td rowspan="" colspan="" dir="auto">
                <p id="N0287" class="tablecontentintable" dir="auto">CreateUnoListener()</p>
            </td>
        </tr>
        <tr>
            <td rowspan="" colspan="" dir="auto">
                <p id="N0288" class="tablecontentintable" dir="auto">See UNO data types</p>
            </td>
            <td rowspan="" colspan="" dir="auto">
                <p id="N0289" class="tablecontentintable" dir="auto">CreateUnoValue()</p>
                <p id="N0290" class="tablecontentintable" dir="auto">CreateObject()</p>
            </td>
        </tr>
        <tr>
            <td rowspan="" colspan="" dir="auto">
            </td>
            <td rowspan="" colspan="" dir="auto">
                <p id="N1244" class="tablecontentintable" dir="auto">EqualUnoObjects()</p>
            </td>
        </tr>
        <tr>
            <td rowspan="" colspan="" dir="auto">
                <p id="N0281" class="tablecontentintable" dir="auto">ctx = uno.getComponentContext()</p>
                <p id="N0282" class="tablecontentintable" dir="auto">smgr = ctx.getServiceManager()</p>
            </td>
            <td rowspan="" colspan="" dir="auto">
                <p id="N0283" class="tablecontentintable" dir="auto">GetProcessServiceManager()</p>
            </td>
        </tr>
        <tr>
            <td rowspan="" colspan="" dir="auto">
                <p id="N0292" class="tablecontentintable" dir="auto">def hasUnoInterfaces(obj, *interfaces):</p>
                <p id="N0293" class="tablecontentintable" dir="auto">return set(interfaces).issubset(t.typeName for t in obj.Types)</p>
                
            </td>
            <td rowspan="" colspan="" dir="auto">
                <p id="N0294" class="tablecontentintable" dir="auto">HasUnoInterfaces()</p>
            </td>
        </tr>
        <tr>
            <td rowspan="" colspan="" dir="auto">
            </td>
            <td rowspan="" colspan="" dir="auto">
                <p id="N0296" class="tablecontentintable" dir="auto">IsUnoStruct()</p>
            </td>
        </tr>
        <tr>
            <td rowspan="" colspan="" dir="auto">
                <p id="N0297" class="tablecontentintable" dir="auto">ctx = uno.getComponentContext()</p>
                <p id="N0298" class="tablecontentintable" dir="auto">smgr = ctx.getServiceManager()</p>
                <p id="N0299" class="tablecontentintable" dir="auto">DESK = 'com.sun.star.frame.Desktop'</p>
                <p id="N0300" class="tablecontentintable" dir="auto">desktop = smgr.createInstanceWithContext(DESK , ctx)</p>
            </td>
            <td rowspan="" colspan="" dir="auto">
                <p id="N0301" class="tablecontentintable" dir="auto">StarDesktop</p>
            </td>
        </tr>
        <tr>
            <td rowspan="" colspan="" dir="auto">
                <p id="N2298" class="tablecontentintable" dir="auto">desktop = smgr.createInstanceWithContext(DESK , ctx)</p>
                <p id="N1299" class="tablecontentintable" dir="auto">doc = desktop.CurrentComponent</p>
            </td>
            <td rowspan="" colspan="" dir="auto">
                <p id="N1301" class="tablecontentintable" dir="auto">ThisComponent</p>
            </td>
        </tr>
    </table>
<br>
    <h2 id="N1297" dir="auto">Importing an embedded Module</h2>
    <a name="PythonEmbeddedImport"></a>
        <p id="N1298" class="paragraph" dir="auto">Similarly to LibreOffice Basic that supports browsing and dynamic loading of libraries, Python libraries can be explored and imported on demand. For more information on library containers, visit <a target="_blank" href="https://api.libreoffice.org/">LibreOffice Application Programming Interface</a> (API) or download <a target="_blank" href="https://www.libreoffice.org/download/download/">LibreOffice Software Development Kit</a> (SDK).</p>
        <p id="N3299" class="paragraph" dir="auto">Importing a Python document embedded module is illustrated below, exception handling is not detailed:</p>
        <div class="pycode" itemscope="true" itemtype="http://schema.org/SoftwareSourceCode" itemprop="codeSampleType" content="snippet" data-tooltip="Click on text to copy to clipboard"><pre dir="auto"><code class="language-python line-numbers">
            import uno, sys, zipimport
            
            def load_library(library_name: str, module_name=None):
                """ load library and import module
                
                Adapted from 'Biblioth√®que de fonctions' by Hubert Lambert
                at https://forum.openoffice.org/fr/forum/viewtopic.php?p=286213"""
                doc = XSCRIPTCONTEXT.getDocument()  # current document
                url = uno.fileUrlToSystemPath( \
                    '{}/{}'.format(doc.URL, 'Scripts/python'+library_name))  # ConvertToURL()
                if not url in sys.path:  # add path if necessary
                    sys.path.insert(0, url)  # doclib takes precedence
                if module_name:  # import if requested
                    return zipimport.zipimporter(url).load_module(module_name)
            
            def import_embedded_python():
                ui = load_library("my_gui",'screen_io')  # add &lt;lib&gt; path + import &lt;module&gt; 
                ui.MsgBox(sys.modules.keys())
            
            g_exportedScripts = (import_embedded_python,)  # Public macros
        </code></pre></div>
    
    <a name="relatedtopics"></a><div class="relatedtopics">
<p class="related" itemprop="mentions" dir="auto"><a name="related"></a><span class="emph">Related Topics</span>
</p>
<div class="relatedbody" itemprop="mentions">
        <p id="N0321" class="paragraph" dir="auto"><a target="_top" href="en-US/text/sbasic/shared/uno_objects.html">Basic UNO Objects, Functions and Services</a></p>
        <div class="embedded"><p class="embedded" dir="auto"><a target="_top" href="en-US/text/sbasic/python/python_import.html">Importing Python Modules</a></p></div>
        <div class="embedded"><p class="embedded" dir="auto"><a target="_top" href="en-US/text/sbasic/python/python_screen.html">Input/Output to Screen</a></p></div>
        <div class="embedded"><p class="embedded" dir="auto"><a target="_top" href="en-US/text/sbasic/python/main0000.html">LibreOffice Python Scripts Help</a></p></div>
    </div>
</div>
</div>
<div id="DonationFrame"></div>
<footer><h2 style="text-align: center;"><a href="https://books.libreoffice.org" target="_blank">LibreOffice Books</a></h2>
<div class="noteicon" dir="auto" style="display:flex;justify-content:center;">
<img src="media/navigation/libo-writer.svg" alt="Writer Icon" style="width:60px;height:60px;"><img src="media/navigation/libo-calc.svg" alt="Calc Icon" style="width:60px;height:60px;"><img src="media/navigation/libo-impress.svg" alt="Impress Icon" style="width:60px;height:60px;"><img src="media/navigation/libo-draw.svg" alt="Draw Icon" style="width:60px;height:60px;"><img src="media/navigation/libo-base.svg" alt="Base Icon" style="width:60px;height:60px;"><img src="media/navigation/libo-math.svg" alt="Math Icon" style="width:60px;height:60px;"><img src="media/navigation/libo-symbol-black.svg" alt="Getting Started Icon" style="width:60px;height:60px;">
</div>
<div id="DEBUG" class="debug">
<h3 class="bug">Help content debug info:</h3>
<p dir="auto">This page is: <a href="https://opengrok.libreoffice.org/xref/help/source/text/sbasic/python/python_programming.xhp" target="_blank">/text/sbasic/python/python_programming.xhp</a></p>
<p dir="auto">Title is: Python : Programming with Python</p>
<p id="bm_module" dir="auto"></p>
<p id="bm_system" dir="auto"></p>
<p id="bm_HID" dir="auto"></p>
</div></footer>
</body>
</html>
