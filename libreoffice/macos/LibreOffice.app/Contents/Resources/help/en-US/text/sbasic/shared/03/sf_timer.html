<!DOCTYPE html>
<html lang="en-US" dir="ltr">
<head>
<base href="../../../../../">
<noscript><meta http-equiv="refresh" content="0; URL=../../../../../en-US/noscript.html"></noscript>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
<title>ScriptForge.Timer service</title>
<link rel="shortcut icon" href="media/navigation/favicon.ico">
<link type="text/css" href="normalize.css" rel="Stylesheet">
<link type="text/css" href="prism.css" rel="Stylesheet">
<link type="text/css" href="default.css" rel="Stylesheet">
<script type="text/javascript" src="polyfills.js"></script><script type="text/javascript" src="languages.js"></script><script type="text/javascript" src="en-US/langnames.js"></script><script type="text/javascript" src="flexsearch.debug.js"></script><script type="text/javascript" src="prism.js"></script><script type="text/javascript" src="help2.js" defer></script><script type="text/javascript" src="a11y-toggle.js" defer></script><script type="text/javascript" src="paginathing.js" defer></script><script type="text/javascript" src="en-US/bookmarks.js" defer></script><script type="text/javascript" src="en-US/contents.js" defer></script><script type="text/javascript" src="help.js" defer></script><meta name="viewport" content="width=device-width,initial-scale=1">
</head>
<body>
<header id="TopLeftHeader"><a class="symbol" href="en-US/text/shared/05/new_help.html"><div></div></a><a class="logo" href="en-US/text/shared/05/new_help.html"><p dir="auto">LibreOffice 24.8 Help</p></a><div class="dropdowns"><div class="modules">
<button type="button" data-a11y-toggle="modules-nav" id="modules" aria-haspopup="true" aria-expanded="false" aria-controls="modules-nav">Module</button><nav id="modules-nav" hidden=""></nav>
</div></div></header><aside class="leftside"><input id="accordion-1" name="accordion-menu" type="checkbox"><label for="accordion-1" dir="auto">Contents</label><div id="Contents" class="contents-treeview"></div></aside><div id="SearchFrame"><div id="Bookmarks">
<input id="search-bar" type="search" class="search" placeholder="Search in bookmarks for chosen module" dir="auto"><div class="nav-container" tabindex="0"><nav class="index" dir="auto"></nav></div>
</div></div>
<div id="DisplayArea" itemprop="softwareHelp" itemscope="true" itemtype="http://schema.org/SoftwareApplication">

<a name="ScriptForge-sf_timer"></a>
   <a name="bm_id261582733781987"></a>
     <meta itemprop="keywords" content="Timer service">
   


<a name="abstract"></a>
  <h1 id="hd_id731582733781114" dir="auto">
<a name="TimerService"></a><span class="literal">ScriptForge</span>.<span class="literal">Timer</span> service</h1>
  <p id="par_id961582733781662" class="paragraph" dir="auto">The <span class="literal">Timer</span> service measures the amount of time it takes to run user scripts.</p>
  <p id="par_id181582733781323" class="paragraph" dir="auto">A <span class="literal">Timer</span> measures <span class="emph">durations</span>. It can be:</p>
  <ul itemprop="Unordered" itemscope="true" itemtype="http://schema.org/ItemList" dir="auto">
    <li itemprop="itemListElement" itemscope="true" itemtype="http://schema.org/ItemListUnordered" dir="auto">
      <p id="par_id711582733781252" class="listitem" dir="auto">Started, to indicate when to start measuring time.</p>
    </li>
    <li itemprop="itemListElement" itemscope="true" itemtype="http://schema.org/ItemListUnordered" dir="auto">
      <p id="par_id631582733781431" class="listitem" dir="auto">Suspended, to pause measuring running time.</p>
    </li>
    <li itemprop="itemListElement" itemscope="true" itemtype="http://schema.org/ItemListUnordered" dir="auto">
      <p id="par_id691582733781498" class="listitem" dir="auto">Resumed, to continue tracking running time after the Timer has been suspended.</p>
    </li>
    <li itemprop="itemListElement" itemscope="true" itemtype="http://schema.org/ItemListUnordered" dir="auto">
      <p id="par_id31582733781344" class="listitem" dir="auto">Restarted, which will cancel previous measurements and start the <span class="literal">Timer</span> at zero.</p>
    </li>
  </ul>

  <div class="tip">
<div class="noteicon" dir="auto"><img src="media/icon-themes/res/helpimg/tip.svg" alt="Tip Icon 
" style="width:40px;height:40px;"></div>
<div class="notetext"><p dir="auto">Durations are expressed in seconds with a precision of 3 decimal digits (milliseconds). A duration value of 12.345 means 12 seconds and 345 milliseconds</p></div>
</div>
<br>

  <h2 id="hd_id201582733781265" dir="auto">Service invocation</h2>
  <p id="par_id141609955500101" class="paragraph" dir="auto">Before using the <span class="literal">Timer</span> service the <span class="literal">ScriptForge</span> library needs to be loaded or imported:</p>
  <div class="embedded">
<a name="importLibs"></a>
    <div class="note">
<div class="noteicon" dir="auto"><img src="media/icon-themes/res/helpimg/note.svg" alt="note" style="width:40px;height:40px;"></div>
<div class="notetext"><p id="par_id901528999850603" dir="auto">• Basic macros require to load <span class="literal">ScriptForge</span> library using the following statement:<br><span class="literal">GlobalScope.BasicLibraries.loadLibrary("ScriptForge")</span><br><br>• Python scripts require an import from <span class="literal">scriptforge</span> module:<br><span class="literal">from scriptforge import CreateScriptService</span>
    </p></div>
</div>
<br>
  </div>

  <div class="embedded">
<a name="In_Basic"></a>
<h5 id="hd_id191620312698501" dir="auto">In Basic</h5>
</div>
  <p id="par_id891610734806133" class="paragraph" dir="auto">The example below creates a <span class="literal">Timer</span> object named <span class="literal">myTimer</span> and starts it immediately.</p>
  <div class="bascode" itemscope="true" itemtype="http://schema.org/SoftwareSourceCode" itemprop="codeSampleType" content="snippet" data-tooltip="Click on text to copy to clipboard"><pre dir="auto"><code class="language-visual-basic line-numbers">
    GlobalScope.BasicLibraries.LoadLibrary("ScriptForge")
    Dim myTimer As Variant
    myTimer = CreateScriptService("Timer", True)
    'The timer starts immediately when the second argument = True, default = False
  </code></pre></div>
  <p id="par_id891582733781994" class="paragraph" dir="auto">It is recommended to free resources after use:</p>
  <div class="bascode" itemscope="true" itemtype="http://schema.org/SoftwareSourceCode" itemprop="codeSampleType" content="snippet" data-tooltip="Click on text to copy to clipboard"><pre dir="auto"><code class="language-visual-basic line-numbers">
    Set myTimer = myTimer.Dispose()
  </code></pre></div>
  <div class="embedded">
<a name="In_Python"></a>
<h5 id="hd_id831620312769993" dir="auto">In Python</h5>
</div>
  <div class="pycode" itemscope="true" itemtype="http://schema.org/SoftwareSourceCode" itemprop="codeSampleType" content="snippet" data-tooltip="Click on text to copy to clipboard"><pre dir="auto"><code class="language-python line-numbers">
    from scriptforge import CreateScriptService
    myTimer = CreateScriptService("Timer", start = True)
    # ...
    myTimer = myTimer.Dispose()
  </code></pre></div>

  <h2 id="hd_id521582733781450" dir="auto">Properties</h2>
  <a name="properties_toc"></a>
   <table border="1" class="" cellpadding="0" cellspacing="0">
    <tr>
        <th rowspan="" colspan="" class="tableheadcell" dir="auto">
            <p id="par_id71582733781260" class="tableheadintable" dir="auto">Name</p>
        </th>
        <th rowspan="" colspan="" class="tableheadcell" dir="auto">
            <p id="par_id711582733781103" class="tableheadintable" dir="auto">Readonly</p>
        </th>
        <th rowspan="" colspan="" class="tableheadcell" dir="auto">
            <p id="par_id76158273378122" class="tableheadintable" dir="auto">Type</p>
        </th>
        <th rowspan="" colspan="" class="tableheadcell" dir="auto">
            <p id="par_id751582733781926" class="tableheadintable" dir="auto">Description</p>
        </th>
    </tr>
    <tr>
        <td rowspan="" colspan="" dir="auto">
            <p id="par_id561582733781781" class="tablecontentintable" dir="auto">Duration</p>
        </td>
        <td rowspan="" colspan="" dir="auto">
            <p id="par_id621582733781588" class="tablecontentintable" dir="auto">Yes</p>
        </td>
        <td rowspan="" colspan="" dir="auto">
            <p id="par_id521582733781943" class="tablecontentintable" dir="auto">Double</p>
        </td>
        <td rowspan="" colspan="" dir="auto">
            <p id="par_id731582733781476" class="tablecontentsintable" dir="auto">The actual running time elapsed since start or between start and stop (does not consider suspended time)</p>
        </td>
    </tr>
    <tr>
        <td rowspan="" colspan="" dir="auto">
            <p id="par_id181582733781163" class="tablecontentintable" dir="auto">IsStarted</p>
        </td>
        <td rowspan="" colspan="" dir="auto">
            <p id="par_id301582733781498" class="tablecontentintable" dir="auto">Yes</p>
        </td>
        <td rowspan="" colspan="" dir="auto">
            <p id="par_id591582733781696" class="tablecontentintable" dir="auto">Boolean</p>
        </td>
        <td rowspan="" colspan="" dir="auto">
            <p id="par_id401582733781608" class="tablecontentsintable" dir="auto"><span class="literal">True</span> when timer is started or suspended</p>
        </td>
    </tr>
    <tr>
        <td rowspan="" colspan="" dir="auto">
            <p id="par_id371582733781716" class="tablecontentintable" dir="auto">IsSuspended</p>
        </td>
        <td rowspan="" colspan="" dir="auto">
            <p id="par_id181582733781551" class="tablecontentintable" dir="auto">Yes</p>
        </td>
        <td rowspan="" colspan="" dir="auto">
            <p id="par_id411582733781116" class="tablecontentintable" dir="auto">Boolean</p>
        </td>
        <td rowspan="" colspan="" dir="auto">
            <p id="par_id161582733781328" class="tablecontentsintable" dir="auto"><span class="literal">True</span> when timer is started and suspended</p>
        </td>
    </tr>
    <tr>
        <td rowspan="" colspan="" dir="auto">
            <p id="par_id691582733781260" class="tablecontentintable" dir="auto">SuspendDuration</p>
        </td>
        <td rowspan="" colspan="" dir="auto">
            <p id="par_id651582733781874" class="tablecontentintable" dir="auto">Yes</p>
        </td>
        <td rowspan="" colspan="" dir="auto">
            <p id="par_id581582733781213" class="tablecontentintable" dir="auto">Double</p>
        </td>
        <td rowspan="" colspan="" dir="auto">
            <p id="par_id171582733781456" class="tablecontentsintable" dir="auto">The actual time elapsed while suspended since start or between start and stop</p>
        </td>
    </tr>
    <tr>
        <td rowspan="" colspan="" dir="auto">
            <p id="par_id411582733781943" class="tablecontentintable" dir="auto">TotalDuration</p>
        </td>
        <td rowspan="" colspan="" dir="auto">
            <p id="par_id141582733781303" class="tablecontentintable" dir="auto">Yes</p>
        </td>
        <td rowspan="" colspan="" dir="auto">
            <p id="par_id451582733781978" class="tablecontentintable" dir="auto">Double</p>
        </td>
        <td rowspan="" colspan="" dir="auto">
            <p id="par_id411582733781932" class="tablecontentsintable" dir="auto">The actual time elapsed since start or between start and stop (including suspensions and running time)</p>
        </td>
    </tr>
   </table>
<br>
  
  <div class="tip">
<div class="noteicon" dir="auto"><img src="media/icon-themes/res/helpimg/tip.svg" alt="Tip Icon 
" style="width:40px;height:40px;"></div>
<div class="notetext"><p dir="auto">Note that the <span class="literal">TotalDuration</span> property is equivalent to summing the <span class="literal">Duration</span> and <span class="literal">SuspendDuration</span> properties.</p></div>
</div>
<br>

  <h2 id="hd_id141582734141895" dir="auto">Methods</h2>
    <p id="par_id291582734377752" class="paragraph" dir="auto">All methods do not require arguments and return a <span class="literal">Boolean</span> value.</p>
    <p id="par_id311582734894257" class="paragraph" dir="auto">If the returned value is <span class="literal">False</span>, then nothing happened.</p>
  <a name="bm_id911610740799006"></a>
    <meta itemprop="keywords" content="Timer service,Continue">
    <meta itemprop="keywords" content="Timer service,Restart">
    <meta itemprop="keywords" content="Timer service,Start">
    <meta itemprop="keywords" content="Timer service,Suspend">
    <meta itemprop="keywords" content="Timer service,Terminate">
  
  <a name="methods_toc"></a>
    <table border="1" class="" cellpadding="0" cellspacing="0">
    <tr>
        <th rowspan="" colspan="" class="tableheadcell" dir="auto">
            <p id="par_id871582734180676" class="tableheadintable" dir="auto">Name</p>
        </th>
        <th rowspan="" colspan="" class="tableheadcell" dir="auto">
            <p id="par_id971582734180676" class="tableheadintable" dir="auto">Description</p>
        </th>
        <th rowspan="" colspan="" class="tableheadcell" dir="auto">
            <p id="par_id911582734180676" class="tableheadintable" dir="auto">Returned value</p>
        </th>
    </tr>
    <tr>
        <td rowspan="" colspan="" dir="auto">
            <p id="par_id31582734180676" class="tablecontentintable" dir="auto">Continue</p>
        </td>
        <td rowspan="" colspan="" dir="auto">
            <p id="par_id301582734180676" class="tablecontentintable" dir="auto">Resumes the <span class="literal">Timer</span> if it has been suspended</p>
        </td>
        <td rowspan="" colspan="" dir="auto">
            <p id="par_id661582734180676" class="tablecontentintable" dir="auto"><span class="literal">False</span> if the timer is not suspended</p>
        </td>
    </tr>
    <tr>
        <td rowspan="" colspan="" dir="auto">
            <p id="par_id881582734649304" class="tablecontentintable" dir="auto">Restart</p>
        </td>
        <td rowspan="" colspan="" dir="auto">
            <p id="par_id821582734649305" class="tablecontentintable" dir="auto">Terminates the <span class="literal">Timer</span> and discards its current property values, restarting as a new clean <span class="literal">Timer</span></p>
        </td>
        <td rowspan="" colspan="" dir="auto">
            <p id="par_id761582734649305" class="tablecontentintable" dir="auto"><span class="literal">False</span> if the timer is inactive</p>
        </td>
    </tr>
    <tr>
        <td rowspan="" colspan="" dir="auto">
            <p id="par_id201582734802443" class="tablecontentintable" dir="auto">Start</p>
        </td>
        <td rowspan="" colspan="" dir="auto">
            <p id="par_id641582734802443" class="tablecontentintable" dir="auto">Starts a new clean timer</p>
        </td>
        <td rowspan="" colspan="" dir="auto">
            <p id="par_id921582734802443" class="tablecontentintable" dir="auto"><span class="literal">False</span> if the timer is already started</p>
        </td>
    </tr>
    <tr>
        <td rowspan="" colspan="" dir="auto">
            <p id="par_id781582734905507" class="tablecontentintable" dir="auto">Suspend</p>
        </td>
        <td rowspan="" colspan="" dir="auto">
            <p id="par_id81582734905507" class="tablecontentintable" dir="auto">Suspends a running timer</p>
        </td>
        <td rowspan="" colspan="" dir="auto">
            <p id="par_id661582734905507" class="tablecontentintable" dir="auto"><span class="literal">False</span> if the timer is not started or already suspended</p>
        </td>
    </tr>
    <tr>
        <td rowspan="" colspan="" dir="auto">
            <p id="par_id771582734996722" class="tablecontentintable" dir="auto">Terminate</p>
        </td>
        <td rowspan="" colspan="" dir="auto">
            <p id="par_id861582734996722" class="tablecontentintable" dir="auto">Stops a running timer</p>
        </td>
        <td rowspan="" colspan="" dir="auto">
            <p id="par_id381582734996722" class="tablecontentintable" dir="auto"><span class="literal">False</span> if the timer is neither started nor suspended</p>
        </td>
    </tr>
   </table>
<br>
  

  <div class="embedded">
<a name="functexample"></a>
<h3 id="hd_id061420171139088233" dir="auto">Example:</h3>
</div>
  <p id="par_id731626871820490" class="paragraph" dir="auto">The examples below in Basic and Python illustrate the use of the methods and properties in the <span class="literal">Timer</span> service.</p>
  <div class="embedded">
<a name="In_Basic"></a>
<h5 id="hd_id191620312698501" dir="auto">In Basic</h5>
</div>
  <div class="bascode" itemscope="true" itemtype="http://schema.org/SoftwareSourceCode" itemprop="codeSampleType" content="snippet" data-tooltip="Click on text to copy to clipboard"><pre dir="auto"><code class="language-visual-basic line-numbers">
    myTimer.Start()
    Wait 500
    myTimer.Suspend()
    'The time elapsed while the Dialog box is open will be counted as suspended time
    MsgBox myTimer.Duration &amp; " " &amp; myTimer.SuspendDuration &amp; " " &amp; myTimer.TotalDuration
    myTimer.Continue()
    Wait 500
    'The time elapsed while the Dialog box is open will be counted as running time
    MsgBox myTimer.Duration &amp; " " &amp; myTimer.SuspendDuration &amp; " " &amp; myTimer.TotalDuration
    myTimer.Terminate()
    'Shows the final time measurements
    MsgBox myTimer.Duration &amp; " " &amp; myTimer.SuspendDuration &amp; " " &amp; myTimer.TotalDuration
  </code></pre></div>
  <div class="note">
<div class="noteicon" dir="auto"><img src="media/icon-themes/res/helpimg/note.svg" alt="note" style="width:40px;height:40px;"></div>
<div class="notetext"><p id="par_id281610740093006" dir="auto">If you call the <span class="literal">Terminate</span> method, subsequent calls for the <span class="literal">Continue</span> method will not resume time measurement. Similarly, after a Timer has been terminated, calling the <span class="literal">Start</span> method will restart it as if it were a clean new Timer.</p></div>
</div>
<br>
  <div class="embedded">
<a name="In_Python"></a>
<h5 id="hd_id831620312769993" dir="auto">In Python</h5>
</div>
  <div class="pycode" itemscope="true" itemtype="http://schema.org/SoftwareSourceCode" itemprop="codeSampleType" content="snippet" data-tooltip="Click on text to copy to clipboard"><pre dir="auto"><code class="language-python line-numbers">
    from time import sleep
    bas = CreateScriptService("Basic")
    myTimer.Start()
    sleep(0.5)
    myTimer.Suspend()
    bas.MsgBox("{} {} {}".format(myTimer.Duration, myTimer.SuspendDuration, myTimer.TotalDuration))
    myTimer.Continue()
    sleep(0.5)
    bas.MsgBox("{} {} {}".format(myTimer.Duration, myTimer.SuspendDuration, myTimer.TotalDuration))
    myTimer.Terminate()
    bas.MsgBox("{} {} {}".format(myTimer.Duration, myTimer.SuspendDuration, myTimer.TotalDuration))
  </code></pre></div>
  <div class="note">
<div class="noteicon" dir="auto"><img src="media/icon-themes/res/helpimg/note.svg" alt="note" style="width:40px;height:40px;"></div>
<div class="notetext"><p id="par_id391626872019832" dir="auto">Be aware that the <span class="literal">Wait</span> function in BASIC takes in a duration argument in milliseconds whereas the <span class="literal">sleep</span> function in Python uses seconds in its argument.</p></div>
</div>
<br>

  <h2 id="hd_id431610989623086" dir="auto">Working with Multiple Timers</h2>
  <p id="par_id741610989639201" class="paragraph" dir="auto">It is possible to instantiate multiple <span class="literal">Timer</span> services in parallel, which gives flexibility in measuring time in different parts of the code.</p>
  <p id="par_id921610989722908" class="paragraph" dir="auto">The following example illustrates how to create two <span class="literal">Timer</span> objects and start them separately.</p>
  <div class="embedded">
<a name="In_Basic"></a>
<h5 id="hd_id191620312698501" dir="auto">In Basic</h5>
</div>
  <div class="bascode" itemscope="true" itemtype="http://schema.org/SoftwareSourceCode" itemprop="codeSampleType" content="snippet" data-tooltip="Click on text to copy to clipboard"><pre dir="auto"><code class="language-visual-basic line-numbers">
    Dim myTimerA as Variant, myTimerB as Variant
    myTimerA = CreateScriptService("Timer")
    myTimerB = CreateScriptService("Timer")
    'Starts myTimerA
    myTimerA.Start()
    Wait 1000 'Wait 1 second (1,000 milliseconds)
    MsgBox myTimerA.Duration &amp; " " &amp; myTimerB.Duration
    'Starts myTimerB
    myTimerB.Start()
    Wait 1000
    MsgBox myTimerA.Duration &amp; " " &amp; myTimerB.Duration
    'Terminate both timers
    myTimerA.Terminate()
    myTimerB.Terminate()
  </code></pre></div>
  <div class="embedded">
<a name="In_Python"></a>
<h5 id="hd_id831620312769993" dir="auto">In Python</h5>
</div>
  <div class="pycode" itemscope="true" itemtype="http://schema.org/SoftwareSourceCode" itemprop="codeSampleType" content="snippet" data-tooltip="Click on text to copy to clipboard"><pre dir="auto"><code class="language-python line-numbers">
    from time import sleep
    myTimerA = CreateScriptService("Timer")
    myTimerB = CreateScriptService("Timer")
    myTimerA.Start()
    sleep(1)
    bas.MsgBox("{} {}".format(myTimerA.Duration, myTimerB.Duration))
    myTimerB.Start()
    sleep(1)
    bas.MsgBox("{} {}".format(myTimerA.Duration, myTimerB.Duration))
    myTimerA.Terminate()
    myTimerB.Terminate()
  </code></pre></div>

  <div class="embedded">
<a name="SF_InternalUse"></a>
      <div class="warning">
<div class="noteicon" dir="auto"><img src="media/icon-themes/res/helpimg/warning.svg" alt="warning" style="width:40px;height:40px;"></div>
<div class="notetext"><p id="par_id851506659675843" dir="auto">All <span class="literal">ScriptForge</span> Basic routines or identifiers that are prefixed with an underscore character "_" are reserved for internal use. They are not meant be used in Basic macros or Python scripts.</p></div>
</div>
<br>
    </div>

  <a name="relatedtopics"></a><div class="relatedtopics">
<p class="related" itemprop="mentions" dir="auto"><a name="related"></a><span class="emph">Related Topics</span>
</p>
<div class="relatedbody" itemprop="mentions">
     <div class="embedded"><p class="embedded" dir="auto"><a target="_top" href="en-US/text/sbasic/shared/03030203.html">Now Function</a></p></div>
     <div class="embedded"><p class="embedded" dir="auto"><a target="_top" href="en-US/text/sbasic/shared/03030303.html">Timer Function</a></p></div>
   </div>
</div>
</div>
<div id="DonationFrame"></div>
<footer><h2 style="text-align: center;"><a href="https://books.libreoffice.org" target="_blank">LibreOffice Books</a></h2>
<div class="noteicon" dir="auto" style="display:flex;justify-content:center;">
<img src="media/navigation/libo-writer.svg" alt="Writer Icon" style="width:60px;height:60px;"><img src="media/navigation/libo-calc.svg" alt="Calc Icon" style="width:60px;height:60px;"><img src="media/navigation/libo-impress.svg" alt="Impress Icon" style="width:60px;height:60px;"><img src="media/navigation/libo-draw.svg" alt="Draw Icon" style="width:60px;height:60px;"><img src="media/navigation/libo-base.svg" alt="Base Icon" style="width:60px;height:60px;"><img src="media/navigation/libo-math.svg" alt="Math Icon" style="width:60px;height:60px;"><img src="media/navigation/libo-symbol-black.svg" alt="Getting Started Icon" style="width:60px;height:60px;">
</div>
<div id="DEBUG" class="debug">
<h3 class="bug">Help content debug info:</h3>
<p dir="auto">This page is: <a href="https://opengrok.libreoffice.org/xref/help/source/text/sbasic/shared/03/sf_timer.xhp" target="_blank">/text/sbasic/shared/03/sf_timer.xhp</a></p>
<p dir="auto">Title is: ScriptForge.Timer service</p>
<p id="bm_module" dir="auto"></p>
<p id="bm_system" dir="auto"></p>
<p id="bm_HID" dir="auto"></p>
</div></footer>
</body>
</html>
